package hostmetrics

import (
	"fmt"
	"path"

	"go.opentelemetry.io/collector/pdata/pmetric"
)

// TransformHostMetricsForElasticCompatibilty computes additional metrics for compatibility with Elastic.
// The scopeMetrics input should be metrics generated by a specific hostmetrics scraper.
// The metrics are modified in place.
func TransformHostMetricsForElasticCompatibilty(scopeMetrics pmetric.ScopeMetrics) error {
	scopeName := scopeMetrics.Scope().Name()
	switch scraper := path.Base(scopeName); scraper {
	case "cpu":
		return transformCPUMetrics(scopeMetrics.Metrics())
	default:
		return fmt.Errorf("no matching transform function found for scope '%s'", scopeName)
	}
}
